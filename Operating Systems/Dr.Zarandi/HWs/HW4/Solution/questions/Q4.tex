\section{سوال چهارم}

در هر عمل تعویض متن (\lr{context switch})، میان دو ریسمان متعلق به یک پردازه، چه مواردی باید ذخیره و بازیابی شوند؟ در صورتی که این عمل میان دو پردازه انجام شود چطور؟ با توجه به پاسخ خود نتیجه‌گیری کنید که چرا در موارد زیادی استفاده از ریسمان‌ها به جای پردازه‌ها در سیستم می‌تواند سودمند باشد.

\begin{qsolve}
	\begin{enumerate}
		\item 
		\textbf{در ریسمات باید موارد زیر ذخیره و بازیابی شود: }\\
		\begin{enumerate}
			\item 
			ثبات‌های پردازنده (\lr{CPU Registers}): شامل شمارنده برنامه (\lr{Program Counter})، اشاره‌گر پشته (\lr{Stack Pointer}) و سایر ثبات‌های عمومی.
			
			\item 
			پشته ریسمان: هر ریسمان دارای پشته مخصوص به خود است؛ بنابراین، وضعیت پشته باید ذخیره و بازیابی شود.
			
			\item 
			اطلاعات وضعیت ریسمان مانند وضعیت اجرای ریسمان، اولویت و اطلاعات زمان‌بندی.
			
		\end{enumerate}
		نکته: چون ریسمان‌ها در یک پردازه مشترک هستند، فضای آدرس حافظه، فایل‌های باز و منابع سیستم بین آن‌ها مشترک است و نیازی به تغییر یا مدیریت مجدد آن‌ها در تعویض متن نیست.
		
		
		\item 
		\textbf{در تعویض متن بین دو پردازه باید: }\\
		\begin{enumerate}
			\item 
			ثبات‌های پردازنده (\lr{CPU Registers}): مشابه تعویض متن بین ریسمان‌ها.
			
			\item 
			فضای آدرس حافظه: باید فضای آدرس حافظه به پردازه جدید تغییر کند؛ این شامل تغییر جداول صفحه (\lr{Page Tables}) و تنظیمات واحد مدیریت حافظه (\lr{MMU}) می‌شود.
			
			\item 
			منابع پردازه: فایل‌های باز، محیط پردازه، اطلاعات امنیتی و سایر منابع اختصاصی پردازه باید مدیریت شوند.
			
			\item 
			پشته پردازه: پشته و داده‌های مرتبط با پردازه جدید باید بارگذاری شوند.
		\end{enumerate}
	نکته: تعویض متن بین پردازه‌ها پیچیده‌تر است زیرا هر پردازه دارای منابع و فضای آدرس حافظه مجزاست.
	\end{enumerate}
	
\end{qsolve}